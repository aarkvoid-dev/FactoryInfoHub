{% extends 'base.html' %}
{% load static %}

{% block title %}Worker Profile - FactoryInfoHub{% endblock %}

{% block content %}
<section class="layout-pt-xl layout-pb-xl">
    <div class="container">
        <div class="row">
            <div class="col-lg-8">
                <div class="card rounded-24 shadow-2 mb-30">
                    <div class="card__body p-40">
                        <div class="d-flex justify-between items-center mb-30">
                            <h2 class="text-24 fw-600">My Profile</h2>
                            <a href="{% url 'workers:worker_list' %}" class="button -sm -outline-primary">View All Workers</a>
                        </div>

                        <form method="post">
                            {% csrf_token %}
                            <div class="row y-gap-20">
                                <div class="col-md-6">
                                    {{ form.full_name.label_tag }}
                                    {{ form.full_name }}
                                    {% if form.full_name.errors %}
                                        <div class="text-danger">{{ form.full_name.errors }}</div>
                                    {% endif %}
                                </div>

                                <div class="col-md-6">
                                    {{ form.phone_number.label_tag }}
                                    {{ form.phone_number }}
                                    {% if form.phone_number.errors %}
                                        <div class="text-danger">{{ form.phone_number.errors }}</div>
                                    {% endif %}
                                </div>

                                <div class="col-md-6">
                                    {{ form.email.label_tag }}
                                    {{ form.email }}
                                    {% if form.email.errors %}
                                        <div class="text-danger">{{ form.email.errors }}</div>
                                    {% endif %}
                                </div>

                                <div class="col-md-6">
                                    {{ form.date_of_birth.label_tag }}
                                    {{ form.date_of_birth }}
                                    {% if form.date_of_birth.errors %}
                                        <div class="text-danger">{{ form.date_of_birth.errors }}</div>
                                    {% endif %}
                                </div>

                                <div class="col-md-6">
                                    {{ form.gender.label_tag }}
                                    {{ form.gender }}
                                    {% if form.gender.errors %}
                                        <div class="text-danger">{{ form.gender.errors }}</div>
                                    {% endif %}
                                </div>

                                <div class="col-md-6">
                                    {{ form.category.label_tag }}
                                    {{ form.category }}
                                    {% if form.category.errors %}
                                        <div class="text-danger">{{ form.category.errors }}</div>
                                    {% endif %}
                                </div>

                                <div class="col-md-6">
                                    {{ form.years_of_experience.label_tag }}
                                    {{ form.years_of_experience }}
                                    {% if form.years_of_experience.errors %}
                                        <div class="text-danger">{{ form.years_of_experience.errors }}</div>
                                    {% endif %}
                                </div>

                                <div class="col-12">
                                    {{ form.skills.label_tag }}
                                    {{ form.skills }}
                                    {% if form.skills.errors %}
                                        <div class="text-danger">{{ form.skills.errors }}</div>
                                    {% endif %}
                                </div>

                                <div class="col-md-6">
                                    {{ form.availability.label_tag }}
                                    {{ form.availability }}
                                    {% if form.availability.errors %}
                                        <div class="text-danger">{{ form.availability.errors }}</div>
                                    {% endif %}
                                </div>

                                <div class="col-md-6">
                                    {{ form.expected_daily_wage.label_tag }}
                                    {{ form.expected_daily_wage }}
                                    {% if form.expected_daily_wage.errors %}
                                        <div class="text-danger">{{ form.expected_daily_wage.errors }}</div>
                                    {% endif %}
                                </div>

                                <div class="col-12">
                                    <button type="submit" class="button -lg -primary w-full">Update Profile</button>
                                </div>
                            </div>
                        </form>
                    </div>
                </div>

                <div class="card rounded-24 shadow-2">
                    <div class="card__body p-40">
                        <div class="d-flex justify-between items-center mb-30">
                            <h3 class="text-20 fw-600">Work Experience</h3>
                            <a href="{% url 'workers:add_work_experience' %}" class="button -sm -primary">Add Experience</a>
                        </div>

                        {% if worker.experiences.exists %}
                            <div class="row y-gap-20">
                                {% for experience in worker.experiences.all %}
                                <div class="col-12">
                                    <div class="card rounded-12 p-20">
                                        <div class="d-flex justify-between items-start">
                                            <div>
                                                <h4 class="text-16 fw-600">{{ experience.company_name }}</h4>
                                                <p class="text-14 text-muted">{{ experience.job_title }}</p>
                                                <p class="text-13 text-muted">
                                                    {{ experience.start_date }} - 
                                                    {% if experience.end_date %}
                                                        {{ experience.end_date }}
                                                    {% else %}
                                                        Present
                                                    {% endif %}
                                                </p>
                                                <p class="text-14 mt-10">{{ experience.description }}</p>
                                            </div>
                                            <div class="d-flex flex-col gap-10">
                                                <a href="{% url 'workers:edit_work_experience' experience.id %}" class="button -sm -outline-primary">Edit</a>
                                                <a href="{% url 'workers:delete_work_experience' experience.id %}" class="button -sm -outline-danger">Delete</a>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                {% endfor %}
                            </div>
                        {% else %}
                            <p class="text-center text-muted py-40">No work experience added yet. <a href="{% url 'workers:add_work_experience' %}" class="text-accent-1">Add your first experience</a></p>
                        {% endif %}
                    </div>
                </div>
            </div>

            <div class="col-lg-4">
                <div class="card rounded-24 shadow-2">
                    <div class="card__body p-40">
                        <div class="text-center mb-30">
                            <h3 class="text-20 fw-600">Worker Information</h3>
                        </div>

                        <div class="worker-info">
                            <div class="mb-20">
                                <h4 class="text-16 fw-500 mb-10">Category</h4>
                                <p class="text-14">{{ worker.category }}</p>
                            </div>

                            <div class="mb-20">
                                <h4 class="text-16 fw-500 mb-10">Experience</h4>
                                <p class="text-14">{{ worker.years_of_experience }} years</p>
                            </div>

                            <div class="mb-20">
                                <h4 class="text-16 fw-500 mb-10">Skills</h4>
                                <p class="text-14">{{ worker.skills }}</p>
                            </div>

                            <div class="mb-20">
                                <h4 class="text-16 fw-500 mb-10">Availability</h4>
                                <p class="text-14">{{ worker.availability }}</p>
                            </div>

                            <div class="mb-20">
                                <h4 class="text-16 fw-500 mb-10">Expected Daily Wage</h4>
                                <p class="text-14">&#8377; {{ worker.expected_daily_wage }}/day</p>
                            </div>

                            <div class="mb-20">
                                <h4 class="text-16 fw-500 mb-10">Location</h4>
                                <p class="text-14">{{ worker.city }}, {{ worker.state }}</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>
{% endblock %}